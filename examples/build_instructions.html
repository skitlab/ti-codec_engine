<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- --COPYRIGHT--,BSD
 *  Copyright (c) 2012, Texas Instruments Incorporated
 *  All rights reserved.
 *
 *  Redistribution and use in source and binary forms, with or without
 *  modification, are permitted provided that the following conditions
 *  are met:
 *
 *  *  Redistributions of source code must retain the above copyright
 *     notice, this list of conditions and the following disclaimer.
 *
 *  *  Redistributions in binary form must reproduce the above copyright
 *     notice, this list of conditions and the following disclaimer in the
 *     documentation and/or other materials provided with the distribution.
 *
 *  *  Neither the name of Texas Instruments Incorporated nor the names of
 *     its contributors may be used to endorse or promote products derived
 *     from this software without specific prior written permission.
 *
 *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 *  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
 *  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 *  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
 *  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 *  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 *  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;
 *  OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
 *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
 *  OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 *  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 * --/COPYRIGHT--
-->
<html>
<head>
    <title>Codec Engine Example Build Instructions</title>
    <!-- For now, we use the doxygen style sheet -->
    <link type="text/css" rel="stylesheet" href="../docs/html/doxygen.css">
    <!-- doxygen's css .memproto's all have tables for a little extra pad...
         don't like tables, so give 'em a little extra left pad ourselves
    --->
    <style type="text/css">
    body {
        margin: 20px;
    }
    </style>
</head>
<body>
<table width="100%">
  <tbody>
    <tr>
      <td bgcolor="black" width="1">
        <a href="http://www.ti.com">
          <img src="../docs/html/tilogo.gif" border="0" alt="Texas
          Instruments">
        </a>
      </td>
      <td bgcolor="red">
        <img src="../docs/html/titagline.gif" alt="Technology for
        Innovators(tm)">
      </td>
    </tr>
  </tbody>
</table>
<h1>Build/Run Instructions for Codec Engine Examples</h1>
<hr>
<h2>General Information</h2>
<p>This page explains how to build the examples provided in the
Codec Engine (CE) product.
</p>
<p>Examples currently contain the simple pass-through (copy) codecs,
implemented in the XDM algorithm standard.
</p>
<p>More details are available at the
  <a href="http://tiexpressdsp.com/index.php?title=Codec_Engine_Examples">
   Codec Engine Examples</a> wiki article.
</p>
<hr>
<h2>Requirements</h2>
<p>See the <a href="../codec_engine_3_22_01_06_ReleaseNotes.html">Release Notes</a>
for the specific software and hardware components this release of
Codec Engine has been validated against.
</p>
<hr>
<h2>Directory Structure</h2>
<p>This section describes the layout under the examples directory.  In
most cases, these examples are XDC packages, and there are links to
the autogenerated XDC documentation.  In some cases, the
examples are not proper XDC packages, and documentation is provided
in other means (see the specific example's directory).
</p>
<pre>
examples
    +---ti
        +---sdo
            +---ce
                +---examples    <span style="color: rgb(0, 164, 0);">Buildable example codecs, servers, and apps</span>
                    +---codecs
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/auddec1_copy/package.html">auddec1_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/auddec1_ires/package.html">auddec1_ires</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/auddec_copy/package.html">auddec_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/audenc1_copy/package.html">audenc1_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/audenc_copy/package.html">audenc_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/g711/package.html">g711</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/imgdec1_copy/package.html">imgdec1_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/imgdec_copy/package.html">imgdec_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/imgenc1_copy/package.html">imgenc1_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/imgenc_copy/package.html">imgenc_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/scale/package.html">scale</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/sphdec1_copy/package.html">sphdec1_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/sphdec_copy/package.html">sphdec_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/sphenc1_copy/package.html">sphenc1_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/sphenc_copy/package.html">sphenc_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/universal_copy/package.html">universalcopy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/vidanalytics_copy/package.html">vidanalytics_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/viddec1_copy/package.html">viddec1_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/viddec2_copy/package.html">viddec2_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/viddec2split_copy/package.html">viddec2split_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/viddec3_copy/package.html">viddec3_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/viddec_copy/package.html">viddec_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/videnc1_copy/package.html">videnc1_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/videnc2_copy/package.html">videnc2_copy</a>
                    |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/videnc_copy/package.html">videnc_copy</a>
                    |   `---<a href="../xdoc/index.html#ti/sdo/ce/examples/codecs/vidtranscode_copy/package.html">vidtranscode_copy</a>
                    |
                    +---extensions
                    |   `---<a href="../xdoc/index.html#ti/sdo/ce/examples/extensions/scale/package.html">scale</a>
                    |
                    +---servers
                    |   `---<a href="../xdoc/index.html#ti/sdo/ce/examples/servers/all_codecs/package.html">all_codecs</a>
                    |
                    +---apps
                        +---audio1_copy
                        |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/audio1_copy/async/package.html">async</a>
                        |   +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/audio1_copy/sync/package.html">sync</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/audio1_ires/package.html">audio1_ires</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/audio_copy/package.html">audio_copy</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/image1_copy/package.html">image1_copy</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/image_copy/package.html">image_copy</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/scale/package.html">scale</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/server_api_example/package.html">server_api_example</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/server_trace/package.html">server_trace</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/speech/package.html">speech</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/speech1_copy/package.html">speech1_copy</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/speech_copy/package.html">speech_copy</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/universal_copy/package.html">universal_copy</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/vidanalytics/package.html">vidanalytics</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/video1_copy/package.html">video1_copy</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/video2_copy/package.html">video2_copy</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/video2split_copy/package.html">video2split_copy</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/video3_copy/package.html">video3_copy</a>
                        +---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/video_copy/package.html">video_copy</a>
                        `---<a href="../xdoc/index.html#ti/sdo/ce/examples/apps/vidtranscode/package.html">vidtranscode</a>
</pre>

<hr>
<h2>Building the examples: step-by-step instructions</h2>
<h3>1. [Optional] Copy the entire "examples" tree out of the product</h3>
<p>
This step is optional, but recommended if you plan to modify the
samples in any way. It will ensure you have a backup copy of the
original examples, as provided by the Codec Engine product.
</p>
<p><i>Important</i>: throughout the rest of this document, we will use the
following notation:
</p>
<ul>
  <li><tt>&lt;CE_EXAMPLES_INSTALL_DIR&gt;</tt> - absolute path of the
  examples directory or the copy you made,
  e.g. <tt>/usr/work/examples</tt></li>
  <li><tt>&lt;CE_INSTALL_DIR&gt;</tt> - root directory of your Codec Engine
  installation. The original examples are in
  <tt>&lt;CE_INSTALL_DIR&gt;/examples</tt>.</li>
  <li><tt>&lt;BIOS_INSTALL_DIR&gt;</tt> - root directory of your DSP/BIOS
  installation.</li>
  <li><tt>&lt;XDC_INSTALL_DIR&gt;</tt> - root directory of your xdctools
  installation.</li>
  <li><i>directory/file</i> - position of the file relative to the
  examples directory; for examples, <tt>ti/sdo/ce/examples/codecs/makefile</tt> refers to
  <tt>&lt;CE_EXAMPLES_INSTALL_DIR&gt;ti/sdo/ce/examples/codecs/makefile</tt>.</li>
</ul>

<h3>2. Manage xdcpaths.mak and products.mak</h3>
<p>
At the root of the Examples directory, there is a
<b>xdcpaths.mak</b> file which has to be edited for your particular usecase.
Edit the following variables described below
</p>
<p>
The variables defined in <b>xdcpaths.mak</b> that most users must
assign are:  <tt>DEVICE</tt>, <tt>GPPOS</tt>, and <tt>PROGRAMS</tt>.
Each are described in comments throughout the <b>xdcpaths.mak</b> file.
</p>
<p>
Advanced users will note that these GNU make-based variables can be
overridden on the command line.  As a result, it is possible to tailor
these makefiles without modifying them - by simply setting the variables
on the command line when running "gmake".
</p>

<h4>2.1 xdcpaths.mak's DEVICE variable</h4>
<p>
The <tt>DEVICE</tt> variable indicates which hardware platforms should be
built for.  Most users are only interested in building for a single
platform, and the other platforms can be removed from the <tt>DEVICE</tt>
variable.
</p>

<h4>2.2 xdcpaths.mak's GPPOS variable</h4>
<p>
The <tt>GPPOS</tt> variable indicates which GPP (General Purpose Processor,
often an ARM) OS's should be built for.  Most users are only interested in
building for a single GPP OS (e.g. Linux glibc),
and the other GPP OS's can be removed from the <tt>GPPOS</tt> variable.
</p>
<p>
If you are on a single-core or multi-core BIOS-only system, the <tt>GPPOS</tt>
variable is ignored.
</p>

<h4>2.3 xdcpaths.mak's PROGRAMS variable</h4>
<p>
The <tt>PROGRAMS</tt> variable indicates roughly which system architecture
the examples should be built for.  Generally, Codec Engine supports "local"
and "remote" codecs, and as a result there are 3 types of executables that
can be built - <tt>APP_LOCAL</tt>, <tt>APP_CLIENT</tt> and
<tt>DSP_SERVER</tt>.</p>
<p>
<tt>APP_LOCAL</tt> indicates that all examples that support the apps and
algorithms running on the same processor should be built.  This is typically
set for single core devices (e.g. DM365, DM6437), but can also be set for
multi-core devices (e.g. OMAP3530, C6472).  In heterogenous
multi-core systems (e.g. OMAP3530), a 'local' app will be built for each core.
In homogeneous multi-core systems (e.g. C6472), a 'local' app will be built
for a single core.
</p>
<p>
<tt>APP_CLIENT</tt> and <tt>DSP_SERVER</tt> typically go together, and
indicate that all examples that support remote execution of algorithms should
be built.  If <tt>DSP_SERVER</tt> is set in the <tt>PROGRAMS</tt> variable
and an appropriate multi-core platform is set in the <tt>DEVICES</tt>
variable, the examples in <b>examples/ti/sdo/ce/examples/servers</b> may be
built.  <tt>APP_CLIENT</tt> indicates the "client" side of a "client/server"
system, so 'client' apps (e.g., GPP-side apps for heterogenous systems and
'master' core apps for homogeneous systems) will be built.
<p>
Note that you can set all 3 (<tt>APP_LOCAL</tt>, <tt>APP_CLIENT</tt>, and
<tt>DSP_SERVER</tt>) or any subset of them.  As a further example, if only
<tt>DSP_SERVER</tt> is set, no applications will be built, but all
components required to create a server (including algorithms) will be built.
</p>

<h4>2.4 CE_INSTALL_DIR</h4>
<p>
The <tt>CE_INSTALL_DIR</tt> variable indicates where the CE product is
installed.
<p>

<h3>3. Dependencies</h3>
<p>Dependencies can be set in $(CE_INSTALL_DIR)/products.mak, which is then
included by <b>examples/xdcpaths.mak</b>.</p>
<h4>INSTALL_DIR</h4>
<ul>
  <li> The many <b>INSTALL_DIR</b> variables let you set the path to other
  dependent components. Depending on the programs you are building and the
  devices you build for, you will need to set the path for one or more of
  these components.  If your distribution includes cetools/, you can set
  many of these variables to $(FC_INSTALL_DIR)/cetools.
  </li>
</ul>

<h4>Codegen Tools</h4>
<ul>
  <li>Correct code generation tool paths will need to be specified for the
  architectures you will be building for. For instance, to build for the C6472
  device, you will need to set the appropriate cgtools variables to the TI C64x
  toolchain location.<br />
  Note that for TI toolchains, this is the directory that contains bin/,
  include/, and lib/ subdirectories.<br />
  To disable the build for a given architecture for your device, ensure that
  the corresponding cgtools variables are undefined.  For example, to disable
  M3elf builds for the TI816X device, don't assign the M3 ELF cgtools variable.
  </li>
</ul>




<p>
Each directory contains a GNU <tt>makefile</tt> which enables you to build
the sample in the current directory.  Top-level directories also
contain a <tt>makefile</tt> which steps into subdirectories and builds
all the examples under the parent directory.
<p>FYI, the xdcpaths.mak file is included by the individual makefiles
for all the example codecs, servers, and applications.</p>
<p>Please keep in mind that <b><span style="color: rgb(153, 0, 0);">MOST
BUILD TROUBLES OCCUR WHEN ONE OF THE VARIOUS <tt>*_INSTALL_DIR</tt>
VARIABLES ARE INCORRECT!</span></b>
Make sure there are no extra spaces (check the end of lines!), that every
individual path (segment separated by the semicolon) is correct, character
for character, and the build process is very likely to go smoothly.
</p>


<h3>4. Build examples</h3>
<p>After updating the variables described above, from your examples/ directory, type:</p>
<p>&nbsp;&nbsp;&nbsp; <b>gmake clean<br>
&nbsp;&nbsp;&nbsp; gmake</b></p>

<p>All examples appropriate for your specified environment and device will be
built.  This will include codecs, extensions, servers (if applicable) and
apps.</p>

<hr>
<h2>Running the example applications</h2>

<p>Most of the Codec Engine examples are designed to support both local and
remote application configurations, and are portable to multiple platforms.
Linux based systems require the loading of one or more kernel drivers
in order to run the examples.  This is described in the following section.

<h3>Installing Kernel Drivers for Linux Based Systems</h3>

Linux based systems require the <b>CMEM</b> driver to be loaded, and
if remote processing is to be supported, the <b>SysLink</b> driver most also
be loaded.  A shell script, <i>loadmodules.sh</i>, is provided to facilitate
this.
</p>
<p>
We will use the following additional notation:
</p>
<ul>
  <li><tt>&lt;CMEM_INSTALL_DIR&gt;</tt> - root directory of your Linux Utils
  installation.
  <li><tt>&lt;LINK_INSTALL_DIR&gt;</tt> - root directory of your SysLink
  installation.</li>
</ul>
<p>We assume you have your EVM properly set up, and that you
are able to mount an NFS.
</p>
<p>You must pass the <b><span style="color: rgb(204, 0, 0);">MEM=120M</span></b>
(or less than 120M) parameter to your Linux kernel from your u-boot
prompt, or you must have your Linux kernel configured to use no more
than 120MB of physical memory. Read more in the following sections
about the memory map.
</p>
<p>Copy the following necessary files into a directory visible from the
EVM board (e.g. an NFS or hard drive mount, etc):
</p>
<ul>
  <li><b>syslink.ko</b>, the SysLink driver, which you built in your
  LINK_INSTALL_DIR, according to SysLink build instructions. Please
  refer to the 
    <a href="http://processors.wiki.ti.com/index.php/SysLink_Install_Guide">
    SysLink Install Guide</a> for instructions on building the
  SysLink driver.
  <li><b>cmemk.ko</b>, a Contiguous Memory allocator that allows
  allocation of physically contiguous buffers of arbitrary sizes (even
  several MB) on the GPP.  You will need to have built this file in your
   CMEM_INSTALL_DIR, according to the "readme.txt" file located in
   &lt;CMEM_INSTALL_DIR&gt;/packages/ti/sdo/linuxutils/cmem.
  <li><b>loadmodules.sh</b> and <b>unloadmodules.sh</b>, example
  scripts for loading any necessary kernel modules.  Some platforms
  have different module dependencies than others, so the contents of
  these scripts may vary between platforms.  These files can be found in
  &lt;CE_INSTALL_DIR&gt;/examples/apps/system_files/&lt;platform&gt;.</li>
</ul>
<p>
The following line in loadmodules.sh, specifies the start and end addresses
of CMEM memory, and instructs the CMEM module to set aside
three pools, one containing 20 4K buffers, one containg 10 128K buffers, and
the third containing two 1MB buffers.
<p>
<b>CMEM_MODPARAMS="phys_start=0xa0000000 phys_end=0xa07fffff
pools=20x4096,10x131072,2x1048576"</b>
</p>

This is good enough for the Codec Engine example applications; your
application will likely need different settings.<br>
</p>
<p>When you run the <i>loadmodules.sh</i> script, you should see output
similar to the following (if the output does not appear on the console,
try running <i>dmesg</i> to see the output):
</p>
<pre>
    $ ./loadmodules.sh
      SysLink version : 2.10.02.17
      SysLink module created on Date:Jan 15 2012 Time:15:23:23
      Trace disabled
      Trace entry/leave prints enabled
      Trace SetFailureReason enabled
      CMEMK module: built on Sep 9 2011 at 16:05:39
        Reference Linux version 2.6.37
        File /db/atree/library/trees/ce/ce-t03/imports/ti/sdo/linuxutils/cmem/src/module/cmemk.c
      allocated heap buffer 0xc9000000 of size 0x4ac000
      cmemk initialized
</pre>

<h3>Command Line Options for Linux Examples</h3>
In order to support multiple platforms and configurations, most Codec Engine
examples running on a Linux-based GPP have the following usage format:
<p>
<b>
app.xv5T [-p proc] [-e engine] [-s serverSuffix] [-m mapFile] input-file output-file
</b>
</p>

The options are:
<p>
<ul>
<li> <i>-p proc</i>. If using a remote server, <i>proc</i> is the name of the
remote processor on which to load the server. For example, "DSP" or
"VIDEO-M3".  If <i>proc</i> is not specified, it is assumed to be "DSP".
</li>
<li> <i>-e engine</i>. Use <i>engine</i>, to specify the name of the engine to
be opened.  This is only necessary when running local apps, as the default
<i>engine</i> is "remote_copy_&lt;proc&gt;", which works for remote apps.
For example, to run speech1_copy locally, you would run:
<p><b> ./app_local.xv5T -e "speech1_copy" </b></p>
</li>
<li> <i>-s serverSuffix</i>. If using a remote server, <i>serverSuffix</i>
is the name of the extension added to the server name to indicate the target
it was built for. For example, "xe674", for C674 Elf targets. The default
value of <i>serverSuffix</i> is "x64P".
</li>
<li> <i>-m mapFile</i>. If the MMU is enabled for the remote processor
where Codec Engine will load the server, <i>mapFile</i> is used to specify
the name of a text file containing the remote processor's memory map.
Codec Engine will use <i>mapFile</i> to map MMU entries. Example map files
are located in the directory:
<p>CE_INSTALL_DIR/examples/ti/sdo/ce/examples/buildutils</p>
They can be modified if needed, and copied to the same directory on your
EVM's file system where you have copied the remote server and app.
</li>
</ul>

<hr>
<h2>Example: Running the universal_copy example application on the TI816X</h2>

<p>Build the examples as described in the previous sections, and copy into
a directory visible from the EVM board. The servers and GPP client executables
must sit in the same directory together).  For example,
to run the universal_copy example, you need:<br>
</p>
<ul>
  <li><b>ti/sdo/ce/examples/servers/all_codecs/&lt;platform&gt;/all.x&lt;suffix&gt;</b></li>
  <li><b>ti/sdo/ce/examples/apps/universal_copy/&lt;platform&gt;/app_remote.xv5T</b></li>
</ul>
<p>You can also copy the sample input file to the same directory:<br>
</p>
<ul>
  <li><b>ti/sdo/ce/examples/apps/universal_copy/in.dat</b></li>
</ul>

<p>Boot the EVM, change to the directory where you have copied cmem.ko,
syslink.ko, and loadmodules.sh, and run<br>
&nbsp;&nbsp;&nbsp; <b>sh ./loadmodules.sh</b>
<br>
to install drivers necessary for your device (e.g. CMEM and
SysLink) with appropriate information about the memory map.
</p>

<p>Next, change to the directory where you have copied the Codec Engine
examples. To run the client application, using the DSP as the remote server,
(which will automatically load the DSP server image):</p>
<p>&nbsp;&nbsp;&nbsp; <b>./app_remote.xv5T -p DSP -s xe674</b><br>
</p>
<p> The <i> -p &lt;procId&gt;</i> option is used to specify which slave
processor is to be loaded with the server image.
The <i> -s &lt;suffix&gt; </i> is
the suffix used in the server executable name: <b>xe674</b> for all_DSP.xe674,
<b>xem3</b> for all_VIDEO-M3.xem3.  The server name for this example
is specified in the configuration file, <i>remote.cfg</i>, located in<br>
&nbsp;&nbsp;&nbsp;&nbsp;
&lt;CE_INSTALL_DIR&gt;/examples/ti/sdo/ce/examples/buildutils<br>
Many of the remote examples use this common configuration file.
<p>You will see several output lines:</p>
<pre>

root@arago:# ./app_remote.xv5T -s xe674
[t=0x000017c7] [tid=0x4007c000] xdc.runtime.Main: main> ti.sdo.ce.examples.apps.universal_copy
[t=0x00001f2e] [tid=0x4007c000] xdc.runtime.Main: [+1] App-> Application started, procId DSP engineName remote_copy_DSP input-file ./in.dat
output-file ./out.dat.
[t=0x000421c5] [tid=0x4007c000] xdc.runtime.Main: [+1] Alg version:  1.00.00.00
[t=0x000435f5] [tid=0x4007c000] xdc.runtime.Main: [+1] App-> Processing frame 0...
[t=0x000437bf] [tid=0x4007c000] xdc.runtime.Main: [+2] App-> Alg frame 0 process returned - 0x0
[t=0x000438a5] [tid=0x4007c000] xdc.runtime.Main: [+1] App-> Processing frame 1...
[t=0x00043a27] [tid=0x4007c000] xdc.runtime.Main: [+2] App-> Alg frame 1 process returned - 0x0
[t=0x00043aae] [tid=0x4007c000] xdc.runtime.Main: [+1] App-> Processing frame 2...
[t=0x00043c39] [tid=0x4007c000] xdc.runtime.Main: [+2] App-> Alg frame 2 process returned - 0x0
[t=0x00043cbd] [tid=0x4007c000] xdc.runtime.Main: [+1] App-> Processing frame 3...
[t=0x00043e22] [tid=0x4007c000] xdc.runtime.Main: [+2] App-> Alg frame 3 process returned - 0x0
[t=0x00043e95] [tid=0x4007c000] xdc.runtime.Main: [+1] 4 frames processed
[t=0x0004f600] [tid=0x4007c000] xdc.runtime.Main: [+1] app done.
root@arago:#

    </pre>
<p>To run the client application, using the VIDEO-M3 or VPSS-M3as the remote
serve, run one of the following commands:</p>
<p>&nbsp;&nbsp;&nbsp; <b>./app_remote.xv5T -p VIDEO-M3 -s xem3</b><br>
&nbsp;&nbsp;&nbsp; <b>./app_remote.xv5T -p VPSS-M3 -s xem3</b><br>
</p>

<p>
To verify that the application has executed correctly, check that the
newly created <b>out.dat</b> file is identical to the input file, 
<b>in.dat</b>.

<hr>
<h2>Example: Running the universal_copy example application on EVM3530</h2>
<p>
Assuming you included <tt>OMAP3530</tt> in <tt>DEVICES</tt>,
<tt>LINUX_GLIBC</tt> in <tt>GPPOS</tt> and <tt>APP_CLIENT</tt> in
<tt>PROGRAMS</tt>, the ARM-side of the universal_copy example for evm3530 will
be built into the
<b>examples/ti/sdo/ce/examples/apps/universal_copy/bin/ti_platforms_evm3530</b>
directory.
Copy the <b>app_remote.xv5T</b> file to the target, along with <b>in.dat</b>
-- which is in the same directory, so on the target both files should be in
the same directory, as well.
<br><br>The configuration file for this example, <b>remote.cfg</b>, is
located in <b>examples/ti/sdo/ce/examples/buildutils</b>, and lists
"all_DSP.x64P" as its DSP server image (indirectly by piecing together,
a <i>serverIds</i> configuration argument passed in from the package.bld
script, and <i>serverSuffix</i>).
<br>So you must copy the <b>all_DSP.x64P</b> DSP
executable for evm3530 from <b>examples/ti/sdo/ce/examples/servers</b>
(more precisely from
<b>
examples/ti/sdo/ce/examples/servers/all_codecs/bin/ti_platforms_evm3530/
</b>)
to the target, in the same directory where the ARM-side executable is.
</p>
<p>
Load the kernel drivers using the <i>loadmodules.sh</i> script, as described
in a previous section. Run the remote example as follows:
<br>
&nbsp;&nbsp;&nbsp;&nbsp;
<b>./app_remote.xv5T</b>
</p>
<p>Note that some OMAP3 systems enable the DSP's MMU, so you'll have to
also use the -m <mapfile.txt> option, like this:
<br>
&nbsp;&nbsp;&nbsp;&nbsp;
<b>./app_remote.xv5T -m omap3530_memmap.txt</b>
</p>

<hr>
<h2>Memory map</h2>
The platform specific memory maps for the <b>all_codecs</b> server are
located in the file
<p>
<b>&lt;CE_INSTALL_DIR&gt;/ti/sdo/ce/examples/servers/all_codecs/serverplatforms.xs</b>
</p>
In case you need to modify the memory map, you can search for your platform
in this file and modify as needed.
Note that each platform memory map has a memory segment named either "SYSLINK"
or "DDR3_SR0". This is used for SysLink communication between the Host and the
remote processor, and the <b>SharedRegion 0</b> is set to this region (see
&lt;platform&gt;.cfg for details).
<p>
If you do change the memory map, you may also need to change the physical start
and end address of CMEM_MODPARAMS in loadmodules.sh, to ensure that CMEM will
not overlap with any of the other memory regions you modified.  You may also
want to change the Linux partion, by modifying the <i>mem=</i> boot argument
in your Linux bootloader.
</p>
For more information on the default memory maps -- as addressed by the kernel
module loading scripts and SYS/BIOS configuration files -- and
instructions on how to change this map, please refer to
<a href="http://tiexpressdsp.com/index.php?title=Changing_the_DVEVM_memory_map">
http://tiexpressdsp.com/index.php?title=Changing_the_DVEVM_memory_map</a>


<hr>
<p>
Last updated: February 24, 2012
</p>
</body>
</html>
